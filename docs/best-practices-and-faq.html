<!DOCTYPE html><html><head><title>Difflicious: Best Practices and Frequently Asked Questions</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Jacob Wang" /><meta name="description" content="Diffs for human consumption" /><meta name="og:image" content="/difflicious/img/poster.png" /><meta name="image" property="og:image" content="/difflicious/img/poster.png" /><meta name="og:title" content="Difflicious: Best Practices and Frequently Asked Questions" /><meta name="title" property="og:title" content="Difflicious: Best Practices and Frequently Asked Questions" /><meta name="og:site_name" content="Difflicious" /><meta name="og:url" content="https://github.com/jatcwang/difflicious" /><meta name="og:type" content="website" /><meta name="og:description" content="Diffs for human consumption" /><link rel="icon" type="image/png" href="/difflicious/img/favicon.png" /><meta name="twitter:title" content="Difflicious: Best Practices and Frequently Asked Questions" /><meta name="twitter:image" content="https://jatcwang.github.io/difflicious/img/poster.png" /><meta name="twitter:description" content="Diffs for human consumption" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/difflicious/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/difflicious/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/difflicious/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/difflicious/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/difflicious/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/difflicious/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/difflicious/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/difflicious/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/difflicious/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/difflicious/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/difflicious/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/difflicious/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/difflicious/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/difflicious/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/difflicious/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/difflicious/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/difflicious/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/difflicious/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/difflicious/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/difflicious/img/favicon310x150.png" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/difflicious/highlight/styles/a11y-light.css" /><link rel="stylesheet" href="/difflicious/css/light-style.css" /><link rel="stylesheet" href="/difflicious/css/main.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><div id="sidebar-brand"><a href="/difflicious/" class="brand"><div class="brand-wrapper"></div><span>Difflicious</span></a><button id="main-toggle" class="sidebar-toggle"><span class="close"></span></button></div><div class="sidebar-nav"> <div class="sidebar-nav-item  "><a href="/difflicious/docs/introduction" title="Introduction" class="">Introduction</a></div> <div class="sidebar-nav-item  "><a href="/difflicious/docs/quickstart" title="Quickstart" class="">Quickstart</a></div> <div class="sidebar-nav-item  "><a href="/difflicious/docs/types-of-differs" title="Types of Differs" class="">Types of Differs</a></div> <div class="sidebar-nav-item  "><a href="/difflicious/docs/configuring-differs" title="Configuring Differs" class="">Configuring Differs</a></div> <div class="sidebar-nav-item  "><a href="/difflicious/docs/library-integrations" title="Library Integrations" class="">Library Integrations</a></div> <div class="sidebar-nav-item active "><a href="/difflicious/docs/best-practices-and-faq" title="Best Practices / FAQ" class="active">Best Practices / FAQ</a></div> <div class="sidebar-nav-item  "><a href="/difflicious/docs/cheatsheet" title="Cheatsheet" class="">Cheatsheet</a></div></div></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="search-nav"><div id="search-dropdown"><label><i class="fa fa-search"></i>Search</label><input id="search-bar" type="text" placeholder="Enter keywords here..." onclick="displayToggleSearch(event)" /><ul id="search-dropdown-content" class="dropdown dropdown-content"></ul></div></li><li id="gh-eyes-item" class="hidden-xs to-uppercase"><a href="https://github.com/jatcwang/difflicious" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs to-uppercase"><a href="https://github.com/jatcwang/difflicious" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="jatcwang" data-github-repo="difflicious"><div class="content-wrapper"><section><h1 id="best-practices">Best Practices</h1>

<h2 id="managing-differ-instances">Managing <code class="language-plaintext highlighter-rouge">Differ</code> instances</h2>

<p>Tests are often the last check for the correctness of your program before it gets deployed, so we need to</p>

<p>Here are some tips to help you best manage <code class="language-plaintext highlighter-rouge">Differ</code> instances when using difflicious for testing:</p>

<ul>
  <li>Only put unmodified derived Differ instances in the implicit scope
    <ul>
      <li>This avoids the scenario where a modified Differ is pulled in accidentally during derivation, which can results in 
passing tests that otherwise should fail.</li>
    </ul>
  </li>
  <li>If you need a modified Differ instance to be used in a derivation, scope it locally</li>
</ul>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">object</span> <span class="nc">DifferInstances</span> <span class="o">{</span>
  <span class="k">implicit</span> <span class="k">val</span> <span class="nv">personDiffer</span><span class="k">:</span> <span class="kt">Differ</span><span class="o">[</span><span class="kt">Person</span><span class="o">]</span> <span class="k">=</span> <span class="nv">Differ</span><span class="o">.</span><span class="py">derive</span><span class="o">[</span><span class="kt">Person</span><span class="o">]</span>
  
  <span class="k">val</span> <span class="nv">personByNameSeqDiffer</span><span class="k">:</span> <span class="kt">Differ</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Person</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">Differ</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Person</span><span class="o">]].</span><span class="py">pairBy</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">name</span><span class="o">)</span>
<span class="o">}</span>

<span class="c1">// ...Somewhere else</span>
<span class="k">val</span> <span class="nv">schoolDiffer</span><span class="k">:</span> <span class="kt">Differ</span><span class="o">[</span><span class="kt">School</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">implicit</span> <span class="k">val</span> <span class="nv">personByNameSeqDiffer</span><span class="k">:</span> <span class="kt">Differ</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Person</span><span class="o">]]</span> <span class="k">=</span> <span class="nv">DifferInstances</span><span class="o">.</span><span class="py">personByNameSeqDiffer</span>
  <span class="nv">Differ</span><span class="o">.</span><span class="py">derive</span><span class="o">[</span><span class="kt">School</span><span class="o">]</span>
<span class="o">}</span>
</code></pre></div></div>

<h1 id="frequently-asked-questions">Frequently Asked Questions</h1>

<h2 id="where-is-fully-automatic-derivation-for-differs">Where is fully automatic derivation for <code class="language-plaintext highlighter-rouge">Differ</code>s?</h2>

<p>Fully automatic derivation is intentionally left out for compile time reasons.</p>

<p>With automatic derivation, the compiler will derive the instances <strong>every time it is needed</strong>.
This very frequently leads to extremely long compile times which isn’t worth the few lines of code it saves you.</p>

<h2 id="how-is-difflicious-different-from-other-projects-that-provides-diffs">How is difflicious different from other projects that provides diffs?</h2>

<p><strong>MUnit</strong>: MUnit’s <code class="language-plaintext highlighter-rouge">assertEquals</code> comes out of the box with diff output for case classes. Users do not need to do anything 
to get the diff output due to its simplicity it isn’t really configurable. It is a good idea to start with MUnit’s <code class="language-plaintext highlighter-rouge">assertEquals</code>
and only use Difflicious when you need its configurability for more complex assertion failures.</p>

<p><strong>DiffX</strong>: DiffX is one of the inspirations of this library and Difflicious aims to support all DiffX features/use cases.</p>

<p>Feature-wise, difflicious has:</p>

<ul>
  <li>Better collection diffing: Difflicious allows you to specify how Seq/Set elements are paired for comparison. 
Pairing also allows you compare Seqs order-independently.</li>
  <li>Better configurability: Difflicious takes a more “structured” approach to configurability, where Differ of a complex type
can still have all its underlying Differs tweaked or even replaced (using <code class="language-plaintext highlighter-rouge">replace</code>). This is handy in some scenarios
where you can reuse existing Differs by “swapping” them in and out of a larger Differ.</li>
</ul>

<p>On the other hand, diffx has:</p>

<ul>
  <li>Opt-in fully automatic derivation, if you want to convenience and willing to accept longer compile times.</li>
</ul>

<p><strong>Note</strong>: Diffx is an actively maintained library, so some comparison may not be up to date and corrections are welcome :)</p>

<h2 id="how-can-i-provide-a-differ-for-my-newtypes--opaque-types">How can I provide a Differ for my newtypes / opaque types?</h2>

<p>Many Scala users like to use a wrapper type around primitive types for additional type-safety.</p>

<p>All <code class="language-plaintext highlighter-rouge">ValueDiffer</code> has a <code class="language-plaintext highlighter-rouge">contramap</code> method you can use.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">UserId</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>

<span class="k">val</span> <span class="nv">userIdDiffer</span><span class="k">:</span> <span class="kt">Differ</span><span class="o">[</span><span class="kt">UserId</span><span class="o">]</span> <span class="k">=</span> <span class="nv">Differ</span><span class="o">.</span><span class="py">stringDiffer</span><span class="o">.</span><span class="py">contramap</span><span class="o">(</span><span class="nv">_</span><span class="o">.</span><span class="py">value</span><span class="o">)</span>
</code></pre></div></div>

<p>Note that the type of Differ.stringDiffer is a <code class="language-plaintext highlighter-rouge">ValueDiffer</code> (<code class="language-plaintext highlighter-rouge">ValueDiffer</code> is a subtype of <code class="language-plaintext highlighter-rouge">Differ</code>)</p>

</section></div></div></div></div><script src="/difflicious/highlight/highlight.pack.js"></script><script src="/difflicious/lunr/lunr.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script>((window.gitter = {}).chat = {}).options = {
room: 'jatcwang/difflicious'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/difflicious/js/search.js"></script><script src="/difflicious/js/docs.js"></script></body></html>